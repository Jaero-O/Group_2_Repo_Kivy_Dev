#:kivy 2.0.0

<RecordTreeItem>:
    orientation: "horizontal"
    size_hint_y: None
    height: 49
    padding: [15, 0, 15, 0]

    canvas.before:
        Color:
            rgba: 232/255, 255/255, 208/255, 1
        RoundedRectangle:
            pos: self.pos
            size: self.size
            radius: [11]
        Color:
            rgba: 0, 0, 0, 0.1
        Line:
            rounded_rectangle: (self.x, self.y, self.width, self.height, 11)
            width: 1

<RecordsScreen>
    canvas.before:
        Color:
            rgba: 248/255, 248/255, 248/255, 1
        Rectangle:
            pos: self.pos
            size: self.size

    # --- HEADER SECTION ---
    BoxLayout:
        orientation: "horizontal"
        size_hint: None, None
        height: 50
        width: self.parent.width
        pos_hint: {"x": 0.06, "y": 0.92}
        spacing: 5.3

        Image:
            source: "app/assets/records.png"
            size_hint: None, None
            size: 35, 35
            allow_stretch: True
            keep_ratio: True
            color: (6/255, 87/255, 6/255, 1)

    BoxLayout:
        orientation: "horizontal"
        size_hint: None, None
        height: 50
        width: self.parent.width
        pos_hint: {"x": 0.17, "y": 0.91}
        spacing: 5.3

        Label:
            text: "Records"
            color: (5/255, 71/255, 5/255, 1)
            font_size: 32
            bold: True
            valign: "middle"
            halign: "left"
            text_size: self.size

    # --- BACK BUTTON ---
    RoundedButton:
        id: back_button
        size_hint: None, None
        size: 100, 36
        pos_hint: {"x": 0.79, "y": 0.915}
        on_release: app.root.current = 'home'

        BoxLayout:
            orientation: "horizontal"
            size: self.size
            spacing: 6
            padding: [0, 0, 0, 0]
            pos_hint: {"center_y": 0.5}
            size: back_button.size
            pos: back_button.pos

            Image:
                source: "app/assets/back.png"
                allow_stretch: True
                keep_ratio: True
                size_hint: None, None
                size: 20, 20
                pos_hint: {"center_y": 0.5}

            Label:
                text: "Back"
                color: (0/255, 121/255, 0/255, 1)
                font_size: 16
                bold: True
                size_hint_x: None
                width: self.texture_size[0]
                halign: "left"
                valign: "middle"
                pos_hint: {"center_y": 0.5}

    # === SEARCH BOX ===
    BoxLayout:
        size_hint: None, None
        size: 400, 35
        pos_hint: {"center_x": 0.5, "top": 0.85}
        padding: [8, 0, 8, 0]
        spacing: 6

        canvas.before:
            Color:
                rgba: 1, 1, 1, 1
            RoundedRectangle:
                pos: self.pos
                size: self.size
                radius: [15, 15, 15, 15]
            Color:
                rgba: 220/255, 220/255, 220/255, 1
            Line:
                rounded_rectangle: (self.x, self.y, self.width, self.height, 15)
                width: 1.1

        TextInput:
            id: search_input
            size_hint_x: 1
            multiline: False
            hint_text: "Search"
            hint_text_color: 166/255, 166/255, 166/255, 1
            foreground_color: 0, 0, 0, 1
            background_color: 0, 0, 0, 0
            padding: [12, (self.height - self.line_height)/2, 0, 0]
            font_size: 14
            cursor_color: 0, 0, 0, 1
            on_text: root.on_search_text(self.text)

        Image:
            source: "app/assets/search.png"
            size_hint: None, None
            size: 17, 17
            allow_stretch: True
            keep_ratio: True
            pos_hint: {"center_y": 0.5}

    # === ACTION BUTTONS (Edit and Delete) ===
    BoxLayout:
        id: action_buttons
        orientation: "horizontal"
        size_hint: None, None
        size: 180, 40
        pos_hint: {"right": 0.89, "top": 0.785}
        spacing: 12
        opacity: 0
        disabled: True

        # Edit Button
        BoxLayout:
            orientation: "horizontal"
            size_hint: None, None
            size: 80, 40
            spacing: 5
            padding: [8, 0, 8, 0]

            canvas.before:
                Color:
                    rgba: 240/255, 248/255, 255/255, 1  # Light blue background
                RoundedRectangle:
                    pos: self.pos
                    size: self.size
                    radius: [8]
                Color:
                    rgba: 100/255, 149/255, 237/255, 0.3  # Blue border
                Line:
                    rounded_rectangle: (self.x, self.y, self.width, self.height, 8)
                    width: 1.5

            Button:
                size_hint: 1, 1
                background_normal: ''
                background_color: 0, 0, 0, 0
                on_release: root.on_edit_button()

                FloatLayout:
                    size: self.parent.size
                    pos: self.parent.pos

                    Image:
                        source: "app/assets/edit.png"
                        size_hint: None, None
                        size: 20, 20
                        pos_hint: {"x": 0.05, "center_y": 0.5}
                        allow_stretch: True
                        keep_ratio: True

                    Label:
                        text: "Edit"
                        color: 30/255, 100/255, 180/255, 1  # Blue text
                        font_size: 14
                        bold: True
                        pos_hint: {"right": 0.95, "center_y": 0.5}
                        size_hint: None, None
                        size: self.texture_size

        # Delete Button
        BoxLayout:
            orientation: "horizontal"
            size_hint: None, None
            size: 88, 40
            spacing: 5
            padding: [6, 0, 6, 0]

            canvas.before:
                Color:
                    rgba: 255/255, 240/255, 240/255, 1  # Light red background
                RoundedRectangle:
                    pos: self.pos
                    size: self.size
                    radius: [8]
                Color:
                    rgba: 220/255, 53/255, 69/255, 0.4  # Red border
                Line:
                    rounded_rectangle: (self.x, self.y, self.width, self.height, 8)
                    width: 1.5

            Button:
                size_hint: 1, 1
                background_normal: ''
                background_color: 0, 0, 0, 0
                on_release: root.on_delete_button()

                FloatLayout:
                    size: self.parent.size
                    pos: self.parent.pos

                    Image:
                        source: "app/assets/delete.png"
                        size_hint: None, None
                        size: 20, 20
                        pos_hint: {"x": 0.05, "center_y": 0.5}
                        allow_stretch: True
                        keep_ratio: True

                    Label:
                        text: "Delete"
                        color: 220/255, 53/255, 69/255, 1
                        font_size: 14
                        bold: True
                        pos_hint: {"right": 0.95, "center_y": 0.5}
                        size_hint: None, None
                        size: self.texture_size

    # === MAIN CONTENT AREA ===
    FloatLayout:
        size_hint: None, None
        size: 400, 460
        pos_hint: {"center_x": 0.5, "y": 0.12}

        # === SCROLLABLE TREE LIST ===
        ScrollView:
            id: scroll_view
            size_hint: None, None
            size: 400, 395
            pos_hint: {"center_x": 0.5, "top": 1}
            bar_width: 6
            bar_color: 200/255, 200/255, 200/255, 1
            bar_inactive_color: 230/255, 230/255, 230/255, 0.5
            scroll_type: ['bars', 'content']
            effect_cls: "ScrollEffect"
            do_scroll_x: False
            do_scroll_y: True

            BoxLayout:
                id: tree_list
                orientation: "vertical"
                spacing: 12
                size_hint_y: None
                height: self.minimum_height
                padding: [28, 12, 28, 20]

        # === ADD NEW TREE BAR ===
        BoxLayout:
            size_hint: None, None
            size: 343, 49
            pos_hint: {"center_x": 0.5, "y": 0}
            spacing: 10
            padding: [15, 0, 10, 0]

            canvas.before:
                Color:
                    rgba: 242/255, 242/255, 242/255, 1
                RoundedRectangle:
                    pos: self.pos
                    size: self.size
                    radius: [11, 11, 11, 11]
                Color:
                    rgba: 0, 0, 0, 0.1
                Line:
                    rounded_rectangle: (self.x, self.y, self.width, self.height, 11)
                    width: 1

            TextInput:
                id: add_input
                hint_text: "Add new tree"
                font_size: 16
                bold: True
                halign: "left"
                valign: "middle"
                foreground_color: 79/255, 79/255, 79/255, 1
                hint_text_color: 166/255, 166/255, 166/255, 1
                background_color: 0, 0, 0, 0
                padding: [8, (self.height - self.line_height)/2, 0, 0]
                multiline: False
                cursor_color: 79/255, 79/255, 79/255, 1
                on_text_validate: root.on_add_tree()

            Button:
                text: "+"
                size_hint: None, 1
                width: 45
                font_size: 28
                background_normal: ""
                background_color: 0, 0, 0, 0
                color: 79/255, 79/255, 79/255, 1
                bold: True
                on_release: root.on_add_tree()