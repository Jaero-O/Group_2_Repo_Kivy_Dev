<HomeScreen>:
    canvas.before:
        # 1. --- Main Background ---
        Color:
            rgba: 242/255., 242/255., 242/255., 1
        Rectangle:
            pos: self.pos
            size: self.size

        # 2. --- Rounded Inner Panel ---
        Color:
            rgba: 237/255., 255/255., 218/255., 1
        RoundedRectangle:
            id: inner_panel
            pos: self.x + 20, self.height - (self.height * 0.7 + 20)
            size: self.width - 40, self.height * 0.7
            radius: [35, 35, 35, 35]

        # 3. --- Border for Inner Panel ---
        Color:
            rgba: 0, 0, 0, 0.10
        Line:
            rounded_rectangle: (self.x + 20, self.height - (self.height * 0.7 + 20), self.width - 40, self.height * 0.7, 35)
            width: 1.2

    # --- Logo inside the inner panel ---
    Image:
        source: "assets/logo.png"
        allow_stretch: True
        keep_ratio: True
        size_hint: None, None
        size: 300, 300
        pos_hint: {"center_x": 0.5, "center_y": 0.6}

    # --- Custom Rounded Scan Button ---
    ScanButton:
        id: scan_btn_container
        size_hint: None, None
        size: 100, 100
        pos_hint: {"center_x": 0.5, "y": 0.20}
        on_release: app.root.current = 'scan'

        canvas.before:
            Color:
                rgba: self.shadow_color
            RoundedRectangle:
                pos: self.x + self.shadow_offset_x, self.y - self.shadow_offset_y
                size: self.size
                radius: [25, 25, 25, 25]

            Color:
                rgba: self.color
            RoundedRectangle:
                pos: self.pos
                size: self.size
                radius: [25, 25, 25, 25]

        RelativeLayout:
            size: scan_btn_container.size
            pos: scan_btn_container.pos

            BoxLayout:
                orientation: "vertical"
                size_hint: 1, 1
                spacing: 2
                padding: [0, 15, 0, 10]

                Image:
                    source: "assets/scan.png"
                    allow_stretch: True
                    keep_ratio: True
                    size_hint_y: 0.65
                    pos_hint: {'center_x': 0.5}

                Label:
                    text: "Scan"
                    color: 0/255., 114/255., 0/255., 1
                    font_size: 16
                    bold: True
                    size_hint_y: 0.35
                    halign: 'center'
                    valign: 'middle'
                    text_size: self.size

    # --- Bottom Buttons (Records, Share, Help) ---
    BoxLayout:
        orientation: "horizontal"
        size_hint_y: None
        height: 95
        pos_hint: {"y": 0.02}
        spacing: 0
        padding: [20, 0, 20, 10]

        # === Records Button ===
        BoxLayout:
            orientation: "vertical"
            size_hint_x: 0.333
            spacing: 0
            on_touch_down:
                if self.collide_point(*args[1].pos): app.root.current = 'records'
            Image:
                source: "assets/records.png"
                size_hint_y: 0.45
                allow_stretch: True
                keep_ratio: True
                pos_hint: {"center_x": 0.5}
            Label:
                text: "Records"
                color: 16/255., 56/255., 16/255., 1
                font_size: 14
                bold: True
                halign: "center"
                valign: "middle"
                text_size: self.size

        # === Share Button ===
        BoxLayout:
            orientation: "vertical"
            size_hint_x: 0.333
            spacing: 0
            on_touch_down:
                if self.collide_point(*args[1].pos): app.root.current = 'share'
            Image:
                source: "assets/share.png"
                size_hint_y: 0.45
                allow_stretch: True
                keep_ratio: True
                pos_hint: {"center_x": 0.5}
            Label:
                text: "Share"
                color: 16/255., 56/255., 16/255., 1
                font_size: 14
                bold: True
                halign: "center"
                valign: "middle"
                text_size: self.size

        # === Help Button ===
        BoxLayout:
            orientation: "vertical"
            size_hint_x: 0.333
            spacing: 0
            on_touch_down:
                if self.collide_point(*args[1].pos): app.root.current = 'help'
            Image:
                source: "assets/help.png"
                size_hint_y: 0.45
                allow_stretch: True
                keep_ratio: True
                pos_hint: {"center_x": 0.5}
            Label:
                text: "Help"
                color: 16/255., 56/255., 16/255., 1
                font_size: 14
                bold: True
                halign: "center"
                valign: "middle"
                text_size: self.size
